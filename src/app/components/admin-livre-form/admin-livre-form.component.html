<div class="container mt-5">
  <h2 class="mb-4 text-center">
    {{ isEdit ? 'Modifier le livre' : 'Ajouter un nouveau livre' }}
  </h2>

  <form (ngSubmit)="onSubmit()" class="card p-4 shadow mb-5" #livreForm="ngForm" novalidate>

    <div class="mb-3">
      <label class="form-label">Titre *</label>
      <input type="text" class="form-control" [(ngModel)]="livre.Titre" name="Titre" required #titre="ngModel" />
      <div class="text-danger mt-1" *ngIf="titre.invalid && titre.touched">
        Le titre est obligatoire.
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">Catégorie *</label>
      <select class="form-select" [(ngModel)]="livre.Categorie" name="Categorie" required #categorie="ngModel">
        <option value="" disabled>-- Sélectionnez une catégorie --</option>
        <option *ngFor="let c of categories" [value]="c">{{ c }}</option>
      </select>
      <div class="text-danger mt-1" *ngIf="categorie.invalid && categorie.touched">
        La catégorie est obligatoire.
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">Prix (€) *</label>
      <input type="number" class="form-control" [(ngModel)]="livre.Prix" name="Prix" required #prix="ngModel" min="0" />
      <div class="text-danger mt-1" *ngIf="prix.invalid && prix.touched">
        Le prix est obligatoire et doit être supérieur ou égal à 0.
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">ISBN *</label>
      <input type="text" class="form-control" [(ngModel)]="livre.Isbn" name="Isbn" required #isbn="ngModel" />
      <div class="text-danger mt-1" *ngIf="isbn.invalid && isbn.touched">
        L'ISBN est obligatoire.
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">Image du livre</label>
      <input type="file" class="form-control" (change)="onFileSelected($event)" />
    </div>

    <div class="mb-3">
      <label class="form-label">Description</label>
      <textarea class="form-control" rows="4" [(ngModel)]="livre.Description" name="Description"></textarea>
    </div>

    <div class="text-end">
      <button class="btn btn-success me-2" [disabled]="loading || livreForm.invalid">
        <i class="bi bi-check-lg"></i> {{ isEdit ? 'Mettre à jour' : 'Créer' }}
      </button>
      <button type="button" class="btn btn-secondary" (click)="router.navigate(['/admin/livres'])">
        Annuler
      </button>
    </div>
  </form>
</div>
